# CVE-2022-23093

On *Dec 01, 2022*, a stack overflow vulnerability CVE-2022-23093 was found in the FreeBSD operating system in the ping utility, which is commonly used to test network connectivity, has the potential to allow remote code execution on affected systems. The vulnerability, which has been identified in the FreeBSD operating system, stems from a failure to properly handle IP option headers in certain network packets.

To demonstrate the severity of this vulnerability, a proof-of-concept exploit was developed in C programming language. The exploit works by sending a specially crafted ICMP packet containing a payload of 'A's to a target IP address, and then receiving and processing the response packet.

The exploit first creates a raw socket for ICMP communication, and constructs an ICMP packet with a payload of 'A's. The packet is then sent to the specified IP address. Upon receiving the response packet, the exploit extracts and prints the IP header and the ICMP header, and also prints the quoted packet if present.

At this point, the exploit injects a shellcode into the payload of the original ICMP packet. The shellcode used in the proof-of-concept exploit is designed to spawn a shell and execute the `/bin/sh` command. Finally, the modified packet is sent to the same IP address.

If successfully exploited, this vulnerability could allow an attacker to execute arbitrary code on affected systems. This could potentially lead to a complete compromise of the system and access to sensitive data.

It is recommended that affected systems be patched as soon as possible to mitigate the risk of exploitation. In addition, network administrators should consider blocking incoming ICMP traffic from untrusted sources as an additional precautionary measure.
